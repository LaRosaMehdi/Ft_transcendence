{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tournament4 Page</title>
    <link rel="stylesheet" href="{% static 'stylesheet.css' %}">
    <link rel="stylesheet" href="{% static 'buttons.css' %}">
    <link rel="stylesheet" href="{% static 'animations.css' %}">
    <link rel="stylesheet" href="{% static 'logos.css' %}">
    <link rel="stylesheet" href="{% static 'perso.css' %}">
    <link rel="stylesheet" href="{% static 'tournament.css' %}">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <h1>Create Tournament</h1>
    <form id="create-tournament-form" method="post">
        {% csrf_token %}
        <label for="name">Tournament Name:</label>
        <input type="text" id="name" name="name" required>
        <button type="submit">Create Tournament</button>
    </form>
    <button type="submit" onclick="javascript:history.go(-1);" class="button back-button"><span></span>
        <span></span>
        <span></span>Back
    </button>
    <script>
        // Add your JavaScript code here to handle user interactions
        document.getElementById('create-tournament-form').addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent the default form submission
            
            // Get the tournament name from the form input
            const tournamentName = document.getElementById('name').value;

            // Perform any validation here if needed

            // Send an AJAX request to create the tournament
            fetch('/api/create_tournament/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': '{{ csrf_token }}' // Include the CSRF token in the header
                },
                body: JSON.stringify({ name: tournamentName }) // Send the tournament name in the request body
            })
            .then(response => {
                if (response.ok) {
                    // Tournament created successfully, redirect or show a success message
                    alert('Tournament created successfully!');
                    window.location.href = '/tournament_list/'; // Redirect to the tournament list page
                } else {
                    // Error handling
                    alert('Failed to create tournament. Please try again.');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('An error occurred. Please try again later.');
            });
        });
    </script>
</body>
</html>